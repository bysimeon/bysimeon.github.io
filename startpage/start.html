<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <title>Home</title>
  <link rel="stylesheet" href="style_start.css">
  <link href="https://fonts.googleapis.com/css?family=Gaegu" rel="stylesheet">
  <link href="favicon.png" rel="shortcut icon" type="image/x-icon" />
</head>
<body>
  <div id="search">
    <input id="search-field" type="text" name="search-field" onkeypress="return search(event)"/>
  </div>
  <div class="container">
    <div id="clock"></div>
    <div class="weather-container">
      <div class="row">
        <div id="weather-description"class="inline"></div>
        <div class="inline">-</div>
        <div id="temp" class="inline"></div>
      </div>
    </div>
    <div class="bookmark-container">
      <div class="bookmark-set">
        <div class="bookmark-title">tools</div>
        <div class="bookmark-inner-container">
          <a class="bookmark" href="https://keep.google.com/" target="_blank">keep</a>
          <a class="bookmark" href="https://inbox.google.com/" target="_blank">inbox</a>
          <a class="bookmark" href="https://github.com/" target="_blank">github</a>
          <a class="bookmark" href="https://drive.google.com/" target="_blank">drive</a>
          <a class="bookmark" href="https://calendar.google.com/" target="_blank">calendar</a>
        </div>
      </div>
      <div class="bookmark-set">
        <div class="bookmark-title">media</div>
        <div class="bookmark-inner-container">
          <a class="bookmark" href="https://netflix.com" target="_blank">netflix</a>
          <a class="bookmark" href="https://youtube.com" target="_blank">youtube</a>
          <a class="bookmark" href="https://twitch.tv" target="_blank">twitch</a>
          <a class="bookmark" href="http://horriblesubs.info" target="_blank">badsubs</a>
          <a class="bookmark" href="https://myanimelist.net" target="_blank">myanimelist</a>
        </div>
      </div>
      <div class="bookmark-set">
        <div class="bookmark-title">reddit</div>
        <div class="bookmark-inner-container">
          <a class="bookmark" href="https://reddit.com/r/programming" target="_blank">/r/programming</a>
          <a class="bookmark" href="https://reddit.com/r/fixedgearbicycle" target="_blank">/r/fixedgears</a>
          <a class="bookmark" href="https://reddit.com/r/unixporn" target="_blank">/r/mechkeyboards</a>
          <a class="bookmark" href="https://reddit.com/r/hiphopheads" target="_blank">/r/hiphopheads</a>
          <a class="bookmark" href="https://reddit.com/r/unixporn" target="_blank">/r/unixporn</a>
          <a class="bookmark" href="https://reddit.com/r/minimalism" target="_blank">/r/minimalism</a>
          <a class="bookmark" href="https://reddit.com/r/startpages" target="_blank">/r/startpages</a>
        </div>
      </div>
      <div class="bookmark-set">
        <div class="bookmark-title">chat</div>
        <div class="bookmark-inner-container">
          <a class="bookmark" href="https://hangouts.google.com/" target="_blank">hangouts</a>
          <a class="bookmark" href="https://allo.google.com/web" target="_blank">allo</a>
          <a class="bookmark" href="https://groupme.com" target="_blank">groupme</a>
        </div>
      </div>
      <div class="bookmark-set">
        <div class="bookmark-title">school</div>
        <div class="bookmark-inner-container">
          <a class="bookmark" href="https://canvas.northwestern.edu" target="_blank">canvas</a>
          <a class="bookmark" href="https://caesar.northwestern.edu" target="_blank">caesar</a>
          <a class="bookmark" href="https://myhr.northwestern.edu" target="_blank">myhr</a>
        </div>
      </div>
    </div>
  </div>

  <script>
  soundcloud = false;
  youtube = false;
  twitch = false;
  myanimelist = false;
    
  // Search on enter key event
  function clear() {
    document.getElementById("search-field").style.background = "#000"
    soundcloud = false;
    youtube = false;
    twitch = false;
    myanimelist = false;
  }

  function cutoff(num, str) {
    if (str.substring(0,1) != " ") {
      num2 = num - 1;
      return num2;
    }
    num2 = num;
    return num2
  }

  function search(e) {
    var val = document.getElementById("search-field").value;
    // break with any of the following in a query
    if (e.keyCode == 13) {
      if (soundcloud) {
        window.open("https://soundcloud.com/search?q=" + val.substr(cutoff(4, val)));
        clear();
      }
      else if (youtube) {
        window.open("https://www.youtube.com/results?search_query=" + val.substr(cutoff(4, val)));
        clear();
      }
      else if (twitch) {
        window.open("https://www.twitch.tv/directory/game/" + val.substr(cutoff(4, val)));
        clear();
      }
      else if (myanimelist) {
        window.open("https://myanimelist.net/search/all?q=" + val.substr(cutoff(4, val)));
        clear();
      }
      else if (val.includes('.com') || val.includes('.net') || val.includes('.co') || val.includes('.io') || val.includes('.xyz') || val.includes('.gov')) {
        window.open("http://" + val.substr(cutoff(1, val)));
      } else {
       window.open("https://google.com/search?q=" + val.substr(cutoff(1, val)));
      }
      document.getElementById('search-field').value = '';
      document.getElementById('search-field').blur();
      document.getElementById('search').style.display = 'none';
    }
    if (val.endsWith('s:') || val.endsWith('S:')) {
      console.log("soundcloud");
      clear();
      soundcloud = true;
      document.getElementById("search-field").style.background = "-webkit-linear-gradient(to right, #fe8c00, #f83600);";
      document.getElementById("search-field").style.background = "linear-gradient(to right, #fe8c00, #f83600);";
    }
    if (val.endsWith('y:') || val.endsWith('Y:')) {
      console.log("youtube");
      clear();
      youtube = true;
      document.getElementById("search-field").style.background = "-webkit-linear-gradient(to right, #e52d27, #b31217);";
      document.getElementById("search-field").style.background = "linear-gradient(to right, #e52d27, #b31217);";
    }
    if (val.endsWith('t:') || val.endsWith('T:')) {
      console.log("twitch");
      clear();
      twitch = true;
      document.getElementById("search-field").style.background = "-webkit-linear-gradient(to right, #6441a5, #2a0845);";
      document.getElementById("search-field").style.background = "linear-gradient(to right, #6441a5, #2a0845);";
    }
    if (val.endsWith('a:') || val.endsWith('A:')) {
      console.log("myanimelist");
      clear();
      myanimelist = true;
      document.getElementById("search-field").style.background = "-webkit-linear-gradient(to right, #1488cc, #2e51a2);";
      document.getElementById("search-field").style.background = "linear-gradient(to right, #1488cc, #2e51a2);";
    }
  }

  // Get current time and format
  function getTime() {
    let date = new Date(),
    min = date.getMinutes(),
    sec = date.getSeconds(),
    hour = date.getHours();

    return "" +
    (hour < 10 ? ("0" + hour) : hour) + ":" +
    (min < 10 ? ("0" + min) : min) + ":" +
    (sec < 10 ? ("0" + sec) : sec);
  }

  window.onload = () => {
    let xhr = new XMLHttpRequest();
    // Request to open weather map
    xhr.open('GET', 'https://cors-anywhere.herokuapp.com/http://api.openweathermap.org/data/2.5/weather?zip=60201,us&units=metric&appid=4119dfca25e96bf1f10f35a975835f6c');
    xhr.onload = () => {
      if (xhr.readyState === 4) {
        if (xhr.status === 200) {
          let json = JSON.parse(xhr.responseText);
          console.log(json);
          document.getElementById("temp").innerHTML = json.main.temp.toFixed(0) + " c";
          document.getElementById("weather-description").innerHTML = json.weather[0].description;
        } else {
          console.log('error msg: ' + xhr.status);
        }
      }
    }
    xhr.send();
    // Set up the clock
    document.getElementById("clock").innerHTML = getTime();
    // Set clock interval to tick clock
    setInterval( () => {
      document.getElementById("clock").innerHTML = getTime();
    },100);
  }

  document.addEventListener("keydown", event => {
    if (event.keyCode == 32) {          // Spacebar code to open search
      document.getElementById('search').style.display = 'flex';
      document.getElementById('search-field').focus();
    } else if (event.keyCode == 27) {   // Esc to close search
      document.getElementById('search-field').value = '';
      document.getElementById('search-field').blur();
      document.getElementById('search').style.display = 'none';
      clear();
    }
  });
  </script>
</body>
</html>
